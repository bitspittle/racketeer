title: Do Crimes
icons:
  cash: "üí∞"
  influence: "ü§ù"
  luck: "üé≤"
  undercover: "ü•∏"
  vp: "‚≠ê"
numTurns: 15
initialHandSize: 5
initialLuck: 0
initialDeck:
  - Pickpocket 5
  - Rumormonger 3
  - Constable 2
cardTypes:
  # Ordered by how they should show up on a card, NOT alphabetically necessarily
  - Action
  - Treasure
  - Thief
  - Spy
  - Trickster
  - Cop
  - Legend

upgradeNames:
  cash: Dextrous
  influence: Artful
  luck: Lucky
  undercover: Undercover

tiers:
  - name: Common
    frequency: 5
  - name: Uncommon
    frequency: 4
  - name: Rare
    frequency: 3
  - name: Scarce
    frequency: 2
  - name: Legendary
    frequency: 1
shopSizes:
  - 3
  - 4
  - 5
  - 6
  - 7
shopPrices:
  - 5
  - 8
  - 11
  - 14
ratingScores:
  # Anything lower than the first score is D
  - 10 # C
  - 20 # B
  - 30 # A
  - 40 # S

globalActions:
  - def 'game-add! '$property '$amount '(game-set! $property '(+ $it $amount))
  - def 'game-sub! '$property '$amount '(game-set! $property '(- $it $amount))
  - def 'card-add! '$card '$property '$amount '(card-set! $card $property '(+ $it $amount))
  - def 'card-sub! '$card '$property '$amount '(card-set! $card $property '(- $it $amount))
  - def 'if-true '$cond '$expr '(if $cond '$expr _)
  - def 'if-false '$cond '$expr '(if $cond _ '$expr)
  - def 'stop-if! '$cond '(if $cond '(stop!) _)
  - def 'cancel-if! '$cond '(if $cond '(cancel!) _)
  - def 'ask? '$prompt '(= (single (choose --prompt icon-convert $prompt (list "Yes" "No") 1) _) "Yes")

cards:
  # TIER 1

  - name: Constable
    tier: 0
    types: [cop]
    flavor: Do nothing.

  - name: Rumormonger
    tier: 0
    types: [spy]
    flavor: Gain &.
    playActions:
      - game-add! 'influence 1

  - name: Pickpocket
    tier: 0
    types: [thief]
    flavor: Gain $.
    playActions:
      - game-add! 'cash 1

  - name: Fool's Gold
    tier: 0
    types: [action]
    cost: 2
    flavor: Gain 4$. Jail this card.
    playActions:
      - game-add! 'cash 4
      - pile-move-to! $jail $this

  - name: Squealer
    tier: 0
    types: [spy]
    cost: 2
    flavor: Gain &. You may jail a card on the Street.
    playActions:
      - game-add! 'influence 1
      - pile-move-to! $jail (choose $street 0 1)

  - name: Plagiarist
    tier: 0
    types: [spy]
    cost: 2
    flavor: Gain 2&.
    playActions:
      - game-add! 'influence 2


  - name: Con Artist
    tier: 0
    types: [thief, spy]
    cost: 2
    flavor: Gain $. Gain &.
    playActions:
      - game-add! 'cash 1
      - game-add! 'influence 1


  - name: Burglar
    tier: 0
    types: [thief]
    flavor: Gain 2$.
    playActions:
      - game-add! 'cash 2


  - name: Croupier
    tier: 0
    types: [thief]
    cost: 3
    flavor: Gain $. Gain %.
    playActions:
      - game-add! 'cash 1
      - game-add! 'luck 1

  - name: Scrounger
    tier: 0
    types: [trickster]
    cost: 4
    flavor: Draw two cards, then discard one.
    playActions: 
      - game-draw! 2
      - pile-move-to! $discard (choose $hand 1)

  - name: I Know a Guy
    tier: 0
    types: [action]
    cost: 4
    flavor: Gain a Burglar on top of your deck.
    playActions:
      - copy-to! --pos 'front $deck (single $all-cards (= card-get $it 'name "Burglar"))

  - name: Card Shark
    tier: 0
    types: [thief, trickster]
    cost: 5
    flavor: Draw a card. Gain 1$.
    playActions:
      - game-draw! 1
      - game-add! 'cash 1

  # TIER 2 (i.e. 1 when 0-indexed)

  - name: Ditch the Goods
    tier: 1
    types: [action]
    cost: 2
    flavor: Discard your hand, then draw that many cards.
    playActions:
      - set '$to-draw-count (size $hand)
      - pile-move-to! $discard $hand
      - game-draw! $to-draw-count

  - name: Cheese It!
    tier: 1
    types: [action]
    cost: 2
    flavor: Jail your hand.
    playActions:
      - pile-move-to! $jail $hand

  - name: Schmoozer
    tier: 1 
    types: [spy, trickster]
    cost: 3
    flavor: Gain 2&. Draw a card, then discard a card.
    playActions: 
      - game-add! 'influence 2
      - game-draw! 1
      - pile-move-to! $discard (choose $hand 1)

  - name: Lady Thistledown
    tier: 1
    types: [spy, legend]
    cost: 3
    flavor: Give a Spy in your hand +1&.
    playActions:
      - card-upgrade! (choose (filter $hand '(card-has-type? 'spy)) 1) 'influence

  - name: Cat the Burglar
    tier: 1
    types: [thief, legend]
    cost: 3
    flavor: Give a Thief in your hand +1$.
    playActions:
      - card-upgrade! (choose (filter $hand '(card-has-type? 'thief)) 1) 'cash


  - name: Roving Gambler
    tier: 1
    types: [thief, spy, trickster]
    cost: 3
    flavor: Gain $. Gain &. Gain %.
    playActions:
      - game-add! 'cash 1
      - game-add! 'influence 1
      - game-add! 'luck 1

  - name: Antique Tome
    tier: 1
    types: [treasure]
    cost: 3
    flavor: Draw a card.
    VP: 2
    playActions:
      - game-draw! 1

  - name: Grift
    tier: 1
    types: [action]
    cost: 4
    flavor: Gain 2&. Add a card from the shop to your deck. Jail this card.
    playActions:
      - game-add! 'influence 2
      - pile-move-to! --pos random $deck (choose $shop 1)
      - pile-move-to! $jail $this

  - name: Embezzler
    tier: 1
    types: [thief, spy]
    cost: 4
    flavor: Choose one: Gain 2$ or Gain 2&.
    playActions:
      - set '$choices (list "Gain 2$" "Gain 2&")
      - set '$chosen-index (indexof $choices choose $choices 1)
      - if-true (= $chosen-index 0) game-add! 'cash 2
      - if-true (= $chosen-index 1) game-add! 'influence 2


  - name: Wanted Poster
    tier: 1  
    types: [action]
    cost: 4
    flavor: Add a random Legend to your discard pile. Jail this card.
    playActions:
      - set '$all-legend-cards (filter $all-cards '(card-has-type? 'legend))
      - set '$random-legend (take --from 'random $all-legend-cards 1)
      - pile-copy-to! $discard $random-legend
      - pile-move-to! $jail $this

 - name: Baby Teeth Nelson
   tier: 3
   types: [thief, legend]
   cost: 5
   flavor: Jail this card and all Cops you own. Gain $ for each.
   playActions: 
     - set '$owned-cops (filter $owned '(card-has-type? 'cop))
     - set '$cash-gained + 1 (size $owned-cops)
     - pile-move-to! $jail $owned-cops
     - pile-move-to! $jail $this
     - game-add! 'cash $cash-gained

 - name: Corrupt Bailiff
   tier: 3
   types: [spy]
   cost: 6
   flavor: Draw a card. You may spend &&&& to give this card ****.
   playActions:
     - game-draw! 1
     - stop-if! < $game-get 'influence 4
     - set '$convert (ask? "Would you like to spend 4& to give this card 4*?")
     - stop-if! ! $convert
     - game-add! 'influence -4
     - card-set! $this 'vp (+ 4 $it)